<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Scheme Details</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
  <style>
    body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background:rgb(229, 227, 235); }
    .btn-success { background-color: rgb(35, 118, 241); border:none; }
  </style>
</head>

<body>
  <!-- Navbar -->
  <nav class="navbar navbar-dark bg-primary">
    <div class="container-fluid">
      <a class="navbar-brand fw-bold" href="schemes.html">Scheme Updater</a>
    </div>
  </nav>

  <!-- Scheme Details -->
  <div class="container mt-5">
    <div class="card shadow p-4">
      <h2 id="schemeName"></h2>
      <p id="schemeAbout"></p>

      <h5>Eligibility:</h5>
      <ul id="schemeEligibility"></ul>

      <h5>Documents Required:</h5>
      <ul id="schemeDocs"></ul>

      <div class="mt-4">
        <button id="downloadBtn" class="btn btn-success">⬇ Download Details</button>
        <a href="javascript:history.back()" class="btn btn-secondary">Back</a>
      </div>
    </div>
  </div>

  <script>
    // Reuse same dataset from category.html
    const ALL_SCHEMES = {
      central: [
        { id: 'c1', title: 'PM-KISAN', about: 'Income support for farmers.', eligibility: ['Farmer families meeting criteria'], docs: ['Aadhaar', 'Bank account'] },
        { id: 'c2', title: 'Pradhan Mantri Awas Yojana', about: 'Affordable housing for all.', eligibility: ['Urban/rural poor'], docs: ['ID proof', 'Address proof'] }
      ],
      state: [
        { id: 's1', title: 'State Farmer Subsidy', about: 'Subsidy for farm input cost.', eligibility: ['Farmers in the state'], docs: ['Land records', 'Bank passbook'] },
        { id: 's2', title: 'State Skill Program', about: 'Skill development program for youth.', eligibility: ['Age 18–35 years'], docs: ['ID', 'Education certificate'] }
      ],
      student: [
        { id: 'st1', title: 'Scholarship A', about: 'Merit-based scholarship.', eligibility: ['Top 10% students'], docs: ['Marksheet', 'ID proof'] }
      ],
      farmer: [
        { id: 'f1', title: 'Crop Insurance', about: 'Financial coverage for crop loss.', eligibility: ['Registered farmers'], docs: ['Land records', 'ID card'] }
      ],
      entrepreneur: [
        { id: 'e1', title: 'Startup Funding', about: 'Seed funding and mentorship for startups.', eligibility: ['Registered startups < 5 yrs'], docs: ['Business plan', 'ID proof'] }
      ],
      healthcare: [
        { id: 'h1', title: 'Health Insurance', about: 'Financial coverage for healthcare.', eligibility: ['Registered healthcare providers'], docs: ['Medical records', 'ID card'] }
    ]    
      };

    // Read parameters from URL
    const params = new URLSearchParams(window.location.search);
    const category = params.get('cat');
    const schemeId = params.get('id');

    // Find the matching scheme
    let scheme;
    if (ALL_SCHEMES[category]) {
      scheme = ALL_SCHEMES[category].find(s => s.id === schemeId);
    }

    // Display scheme data
    if (scheme) {
      document.getElementById('schemeName').innerText = scheme.title;
      document.getElementById('schemeAbout').innerText = scheme.about;
      document.getElementById('schemeEligibility').innerHTML = scheme.eligibility.map(e => `<li>${e}</li>`).join('');
      document.getElementById('schemeDocs').innerHTML = scheme.docs.map(d => `<li>${d}</li>`).join('');
    } else {
      document.querySelector('.card').innerHTML = `<h4>No scheme details found.</h4>`;
    }

    // Download button
    document.getElementById("downloadBtn").addEventListener("click", () => {
      if (!scheme) return;
      const content = 
`Scheme Name: ${scheme.title}

About:
${scheme.about}

Eligibility:
- ${scheme.eligibility.join('\n- ')}

Documents Required:
- ${scheme.docs.join('\n- ')}`;

      const blob = new Blob([content], { type: "text/plain" });
      const link = document.createElement("a");
      link.href = URL.createObjectURL(blob);
      link.download = `${scheme.title.replace(/\s+/g, "_")}_Details.txt`;
      link.click();
    });
  </script>

  <footer class="footer light-background mt-5">
    <div class="container py-4 text-center">
      <p>© <strong>Scheme Updates</strong> All Rights Reserved</p>
    </div>
  </footer>
</body>
</html>
